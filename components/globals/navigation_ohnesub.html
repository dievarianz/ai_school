<!-- ============ NAVIGATION OHNE SUBNAVIGATION ============ -->
<!-- 
  Diese Komponente dient als zentrale Navigation für alle Seiten der Website.
  Im Gegensatz zur navigation.html fehlt hier die Subnavigation für die Tracks.
  
  Um diese Komponente zu verwenden, gibt es zwei Möglichkeiten:
  
  1. Bei HTML-Dateien mit PHP-Unterstützung:
     <?php include('components/includes/navigation_ohnesub.html'); ?>
  
  2. Bei reinen HTML-Dateien mit JavaScript:
     <div id="navigation-container"></div>
     <script>
       fetch('components/includes/navigation_ohnesub.html')
         .then(response => response.text())
         .then(data => {
           document.getElementById('navigation-container').innerHTML = data;
         });
     </script>
  
  Änderungen an dieser Datei werden automatisch auf allen Seiten übernommen,
  die diese Komponente einbinden.
-->

<div class="nav-wrapper">
  <nav class="main-nav">
    <div class="nav-container">
      <a href="index.html" class="nav-logo" data-base-href="index.html">
        <img src="assets/pictures/imt_logo.png" alt="StGallen Integrated imt Business School">
      </a>
      
      <div class="nav-menu">
        <a href="index.html" class="nav-link" data-base-href="index.html">StGallen imt</a>
        <div class="nav-item">
          <a href="#" class="nav-link toggle-subnav">Weiterbildung<svg width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></a>
          <div class="program-dropdown">
            <!-- Erste Spalte: Einzelseminare -->
            <div class="menu-column">
              <h3>Managementseminare</h3>
              <a href="integrated_management_strategy.html" class="program-option" id="integrated-management-option" data-base-href="integrated_management_strategy.html" data-parent-folder="managementseminare">Integrated Management and Strategy</a>
              <a href="financial_management.html" class="program-option" id="financial-management-option" data-base-href="financial_management.html" data-parent-folder="managementseminare">Financial Management</a>
              <a href="inspirational_leadership.html" class="program-option" id="inspirational-leadership-option" data-base-href="inspirational_leadership.html" data-parent-folder="managementseminare">Inspirational Leadership</a>
              <a href="marketing_sales_brand_communication.html" class="program-option" id="marketing-sales-option" data-base-href="marketing_sales_brand_communication.html" data-parent-folder="managementseminare">Marketing, Sales and Brand Communication</a>
              <a href="intelligent_process_automation.html" class="program-option" id="process-automation-option" data-base-href="intelligent_process_automation.html" data-parent-folder="managementseminare">Intelligent Process Automation</a>
              <a href="ai_augmented_decision_making.html" class="program-option" id="ai-decision-making-option" data-base-href="ai_augmented_decision_making.html" data-parent-folder="managementseminare">KI-Augmented Decision Making</a>
            </div>
            
            <!-- Zweite Spalte: Programme -->
            <div class="menu-column">
              <h3>Programme</h3>
              <a href="management_programm.html" class="program-option" data-base-href="management_programm.html">StGallen Management Programm</a>
              <a href="management_programm_cas.html" class="program-option" data-base-href="management_programm_cas.html">StGallen Certified Management CAS</a>
              <a href="ki_excellence_programm.html" class="program-option" data-base-href="ki_excellence_programm.html">StGallen KI Excellence Management Programm</a>
              <a href="fast_track_mba.html" class="program-option" data-base-href="fast_track_mba.html">StGallen Fast Track MBA Programm</a>
            </div>
          </div>
        </div>
        <a href="research.html" class="nav-link" data-base-href="research.html">Forschung</a>
        <a href="netzwerk.html" class="nav-link" data-base-href="netzwerk.html">Netzwerk</a>
        <a href="support.html" class="nav-link" data-base-href="support.html">Support</a>
        <a href="kontakt.html" class="nav-link" data-base-href="kontakt.html">Kontakt</a>
        
        <!-- Mobile Sprachauswahl - nur für die mobile Ansicht -->
        <div class="only-mobile-lang-section">
          <div class="only-mobile-lang-title">Sprache</div>
          <div class="only-mobile-lang-options">
            <a href="#" class="only-mobile-lang-option active" data-lang="de" onclick="return switchLanguage('de', event);"><img src="assets/icons/de-flag-round.png" alt="Deutsch" class="lang-flag-mobile" /> Deutsch</a>
            <a href="#" class="only-mobile-lang-option" data-lang="en" onclick="return switchLanguage('en', event);"><img src="assets/icons/en-flag-round.png" alt="English" class="lang-flag-mobile" /> English</a>
          </div>
        </div>
        
        <!-- Extra space after language selection - increased to 150px -->
        <div style="height: 150px;"></div>
      </div>
      
      <div class="lang-select">
        <a href="#" class="nav-link"><img src="assets/icons/de-flag-round.png" alt="Deutsch" class="lang-flag-nav" /> DE <svg width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></a>
        <div class="program-dropdown lang-dropdown">
          <a href="#" id="lang-de-link" class="program-option active" data-lang="de"><img src="assets/icons/de-flag-round.png" alt="Deutsch" class="lang-flag" /> Deutsch</a>
          <a href="#" id="lang-en-link" class="program-option" data-lang="en"><img src="assets/icons/en-flag-round.png" alt="English" class="lang-flag" /> English</a>
        </div>
      </div>
      
      <button class="mobile-menu-btn" id="mobileMenuButton">
        <div class="hamburger-icon">
          <span class="line line-1"></span>
          <span class="line line-2"></span>
          <span class="line line-3"></span>
        </div>
      </button>
    </div>
  </nav>
</div>

<style>
  :root {
    --font-sans: -apple-system,BlinkMacSystemFont,"San Francisco","Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;
    --color-text: #1d1d1f;
    --color-muted: #6e6e73;
    --color-card-bg: #f5f5f7;
    --color-accent2: #970289;
    --color-badge: #e2b245;
    --color-badge-hover: #d4a535;
    --spacing: 24px;
    --radius: 16px;
    --max-width: 1200px;
    --imt-purple: #6e45e2;
    --swiss-red: #ff0000;
  }

  /* CSS-Klasse, die den Scrollbalken wirklich entfernt */
  body.no-scroll {
    overflow: hidden !important;
    position: fixed !important;
    width: 100% !important;
    height: 100% !important;
    touch-action: none !important;
    overscroll-behavior: none !important;
    -webkit-overflow-scrolling: auto !important;
  }

  /* Bei aktiver Navigation immer den Scrollbalken verstecken */
  .nav-menu.active ~ html body {
    overflow: hidden !important;
  }

  /* Navigation Wrapper und Container */
  .nav-wrapper {
    position: fixed;
    left: 0;
    right: 0;
    top: 0;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    z-index: 1000;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    font-family: var(--font-sans);
    color: var(--color-text);
  }

  .nav-container {
    max-width: var(--max-width);
    width: 90%;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 60px;
    padding: 0;
    position: relative;
  }

  /* Main Navigation */
  .main-nav {
    background: #fff;
    border-bottom: 1px solid rgba(0,0,0,0.1);
    width: 100%;
  }

  .nav-logo {
    display: flex;
    align-items: center;
    margin-right: auto;
    height: 26px;
  }

  .nav-logo img {
    height: 100%;
    width: auto;
  }

  .nav-menu {
    display: flex;
    align-items: center;
    gap: 32px;
    margin-right: 0;
  }

  .nav-link {
    color: var(--color-text);
    text-decoration: none;
    font-size: 0.95rem;
    font-weight: 500;
    white-space: nowrap;
    position: relative;
    padding: 8px 0;
    transition: color 0.2s;
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .nav-link svg {
    margin-left: 2px;
    transition: transform 0.2s ease;
  }

  .nav-link:hover {
    color: var(--color-accent2);
    text-decoration: none !important;
  }

  .nav-link.active {
    color: var(--color-accent2);
    text-decoration: none !important;
  }

  /* Verhindert die Unterstreichung bei allen Navigationslinks */
  .nav-menu a:hover {
    text-decoration: none !important;
  }

  .nav-link.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: var(--color-accent2);
    border-radius: 1px;
  }

  .nav-item:hover .nav-link svg, 
  .lang-select:hover .nav-link svg {
    transform: rotate(180deg);
  }

  /* Dropdown */
  .nav-item {
    position: relative;
  }

  .program-dropdown {
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(-8px);
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    padding: 24px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
    min-width: 850px;
    margin-top: 8px;
    z-index: 1000;
    display: flex;
    gap: 24px;
  }

  .nav-item:hover .program-dropdown,
  .lang-select:hover .program-dropdown {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(0);
  }
  
  /* Spalten für Seminare und Programme */
  .menu-column {
    flex: 1;
  }

  .menu-column h3 {
    font-size: 1rem;
    margin-bottom: 16px;
    color: var(--color-accent2);
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  }
  
  /* Teal-Farbe für Programme-Überschrift */
  .menu-column:nth-child(2) h3 {
    color: #17a689;
  }

  /* Stilregeln für alle Program-Options */
  .program-option {
    display: block;
    padding: 12px 16px;
    color: var(--color-text);
    text-decoration: none;
    font-size: 0.95rem;
    border-radius: 8px;
    transition: all 0.2s ease;
    line-height: 1.4;
    margin-bottom: 4px;
  }

  .program-option:hover {
    background: var(--color-card-bg);
    color: var(--color-accent2);
  }
  
  /* Teal-Farbe für Programme-Options beim Hover */
  .menu-column:nth-child(2) .program-option:hover {
    color: #17a689;
  }
  
  /* Speziell markierte Option - direkt bei der HTML-Definition */
  .highlight-option {
    font-weight: 600;
    background-color: var(--color-card-bg);
    color: var(--color-accent2);
    border-left: 4px solid var(--color-accent2);
    padding-left: 12px;
    border-radius: 0 8px 8px 0; /* Nur rechte Seite abgerundet */
  }
  
  /* Optionen für die Sprachauswahl */
  .lang-dropdown .program-option.active {
    font-weight: 600;
    background-color: var(--color-card-bg);
    color: var(--color-accent2);
    border-left: none;
    padding-left: 16px;
    border-radius: 8px;
  }

  /* Language Selector */
  .lang-select {
    margin-left: 32px;
    position: relative;
  }

  .lang-dropdown {
    right: -16px;
    left: auto;
    min-width: 140px;
    transform: none !important;
    display: block !important;
    padding: 8px !important;
  }

  .lang-select:hover .program-dropdown {
    transform: translateY(0) !important;
  }

  /* Verstecke den Text "Sprache Deutsch English" in der nicht-mobilen Version */
  .nav-container .lang-select + .sprache-text,
  .nav-container .lang-select ~ .sprache-text,
  .nav-container .sprache-text,
  .nav-container > div:last-child:not(.lang-select):not(.mobile-menu-btn),
  .nav-container > div:last-child:not(.lang-select):not(.mobile-menu-btn) .Sprache,
  a[href="#"] + .Sprache,
  .Sprache {
    display: none !important;
  }
  
  /* Explizit die Sprache-Anzeige in der Desktop-Ansicht verbergen */
  .nav-container > .Sprache,
  div.Sprache,
  span.Sprache,
  .Sprache:not(.only-mobile-lang-title),
  .nav-container > [class*="sprache"],
  .nav-wrapper div[class*="sprache"]:not(.only-mobile-lang-title) {
    display: none !important;
  }

  /* Direkte Unterdrückung des "Sprache Deutsch English" Elements auf Seitenebene */
  .nav-wrapper ~ .Sprache,
  body > .Sprache,
  body > div > .Sprache:not(.only-mobile-lang-title),
  nav ~ .Sprache {
    display: none !important;
  }

  /* Mobile Menu */
  .mobile-menu-btn {
    display: none;
    background: none;
    border: none;
    padding: 8px;
    cursor: pointer;
    color: var(--color-text);
    font-size: 24px;
  }

  /* Hamburger Icon Styles */
  .hamburger-icon {
    width: 24px;
    height: 24px;
    position: relative;
  }

  .hamburger-icon .line {
    display: block;
    position: absolute;
    width: 100%;
    height: 2px;
    background-color: var(--color-text);
    border-radius: 2px;
    transition: all 0.3s ease;
    left: 0;
    transform-origin: center;
  }

  .hamburger-icon .line-1 {
    top: 5px;
  }

  .hamburger-icon .line-2 {
    top: 11px;
  }

  .hamburger-icon .line-3 {
    top: 17px;
  }

  /* X-Icon Transformation when menu is active */
  .nav-menu.active ~ .mobile-menu-btn .hamburger-icon .line-1 {
    top: 11px;
    transform: rotate(45deg);
  }

  .nav-menu.active ~ .mobile-menu-btn .hamburger-icon .line-2 {
    opacity: 0;
  }

  .nav-menu.active ~ .mobile-menu-btn .hamburger-icon .line-3 {
    top: 11px;
    transform: rotate(-45deg);
  }

  /* Mobile Styles */
  @media (max-width: 1024px) {
    /* Mobile Navigation */
    .nav-logo {
      z-index: 1010;
      position: relative;
      background-color: white; /* Add background to prevent text showing through */
    }
    
    .nav-container {
      position: sticky;
      top: 0;
      background: white;
      z-index: 1020;
    }
    
    .nav-menu {
      position: fixed;
      top: 60px; /* Höhe der Nav-Container */
      right: -100%;
      width: 100%;
      height: calc(100vh - 60px);
      flex-direction: column;
      align-items: flex-start;
      padding: 20px 24px 20px; /* Reduziertes Padding unten */
      transition: right 0.3s ease;
      z-index: 1000;
      gap: 12px;
      margin-right: 0;
      box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
      overflow-y: scroll; /* Explizit scroll setzen statt auto oder visible */
      -webkit-overflow-scrolling: touch; /* Für besseres Scrolling auf iOS */
      background-color: white; /* Hinzugefügter weißer Hintergrund */
    }
    
    /* Normaler Sprachbereich (nicht fixiert) mit mehr Abstand unten */
    .only-mobile-lang-section {
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid rgba(0, 0, 0, 0.1);
      width: 100%;
      margin-bottom: 150px; /* Viel Platz nach unten */
    }
    
    .nav-menu.active {
      right: 0;
    }
    
    .mobile-menu-btn {
      display: block;
      z-index: 1010;
      background-color: white; /* Add background to prevent text showing through */
    }
    
    .nav-link {
      padding: 12px 0;
      width: 100%;
      font-size: 1.1rem;
    }
    
    .nav-item {
      width: 100%;
    }
    
    .program-dropdown {
      position: static;
      transform: none;
      opacity: 1;
      visibility: visible;
      box-shadow: none;
      padding: 12px 0;
      min-width: auto;
      width: 100%;
      margin-top: 0;
      display: none;
      flex-direction: column;
      gap: 12px;
      border-left: none;
      background: #f8f8f8;
      border-radius: 8px;
      left: 0;
    }
    
    /* Wichtig: Deaktivierung des Hover-Effekts auf mobilen Geräten */
    .nav-item:hover .program-dropdown {
      opacity: 1;
      visibility: visible;
      transform: none;
      display: none;
    }
    
    .menu-column {
      width: 100%;
      padding: 0 12px;
    }
    
    .menu-column h3 {
      margin-top: 10px;
      font-size: 0.9rem;
      padding-left: 12px;
    }
    
    /* Add more space between last item in first column and Programme heading */
    .menu-column:nth-child(2) h3 {
      margin-top: 24px; /* Increased from 10px to 24px for more spacing */
    }
    
    .program-option {
      width: 100%;
      padding: 10px 12px;
      margin-bottom: 5px;
      font-size: 0.95rem;
      white-space: normal;
      line-height: 1.4;
    }
    
    .lang-select {
      display: none; /* Versteckt die Sprachauswahl in der mobilen Ansicht */
    }
    
    .only-mobile-lang-title {
      font-size: 0.9rem;
      color: var(--color-muted);
      margin-bottom: 12px;
      display: block;
    }
    
    .only-mobile-lang-options {
      display: flex;
      gap: 8px;
    }
    
    .only-mobile-lang-option {
      padding: 8px 16px;
      background: var(--color-card-bg);
      border-radius: 30px;
      font-size: 0.9rem;
      color: var(--color-text);
      text-decoration: none;
    }
    
    .only-mobile-lang-option.active {
      background: var(--color-accent2);
      color: white;
    }
  }

  @media (min-width: 1025px) {
    /* Ausblenden der mobilen Sprachauswahl in der Desktop-Ansicht */
    .only-mobile-lang-section {
      display: none !important;
    }
    
    /* Ausblenden des Sprache-Elements in der Desktop-Ansicht */
    .Sprache:not(.only-mobile-lang-title),
    body > div > .Sprache:not(.only-mobile-lang-title),
    .nav-wrapper ~ .Sprache:not(.only-mobile-lang-title),
    div[class^="Sprache"]:not(.only-mobile-lang-title),
    span.Sprache:not(.only-mobile-lang-title) {
      display: none !important;
    }
  }

  /* Swiss Flag Mini */
  .swiss-flag-mini {
    position: relative;
    width: 24px;
    height: 24px;
    background-color: var(--swiss-red);
    border-radius: 2px;
    margin-left: 6px;
  }
  
  .swiss-flag-mini::after {
    content: "";
    position: absolute;
    background-color: white;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 14px;
    height: 14px;
    clip-path: polygon(0% 33%, 33% 33%, 33% 0%, 66% 0%, 66% 33%, 100% 33%, 100% 66%, 66% 66%, 66% 100%, 33% 100%, 33% 66%, 0% 66%);
  }

  .made-in-text {
    font-size: 0.75rem;
    color: var(--color-muted);
    margin-left: 12px;
    display: flex;
    align-items: center;
    font-weight: 500;
  }

  /* Zusätzliche Regeln um unerwünschte Sprachanzeige zu verbergen */
  body > div > .Sprache,
  body > div[class*="sprache"],
  body > div:has(> .Sprache),
  body > div:has(> div > .Sprache),
  nav ~ div:has(.Sprache),
  div:has(> span:contains("Sprache")),
  div.Sprache,
  .Sprache:not(.only-mobile-lang-title *),
  .Sprache ~ a[href^="index"],
  body > .Sprache,
  [class*="sprache"]:not(.only-mobile-lang-title *) {
    display: none !important;
    opacity: 0 !important;
    visibility: hidden !important;
    height: 0 !important;
    width: 0 !important;
    overflow: hidden !important;
    position: absolute !important;
    pointer-events: none !important;
  }

  /* Language Flag Icons */
  .lang-flag {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    margin-right: 8px;
    vertical-align: middle;
    object-fit: cover;
    border: none;
    display: inline-block;
    background-size: contain;
  }
  
  .lang-flag-mobile {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    margin-right: 6px;
    vertical-align: middle;
    object-fit: cover;
    border: none;
    display: inline-block;
    background-size: contain;
  }
  
  .lang-flag-nav {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    margin-right: 4px;
    vertical-align: middle;
    object-fit: cover;
    border: none;
    display: inline-block;
    background-size: contain;
  }
  
  /* Align flag with text in language dropdown */
  .lang-dropdown .program-option {
    display: flex;
    align-items: center;
  }

  /* Align flag with text in mobile language options */
  .mobile-lang-option, .only-mobile-lang-option {
    display: flex;
    align-items: center;
  }

  /* Align flag with language in top nav */
  .nav-link img + svg,
  .nav-link img {
    display: inline-block;
    vertical-align: middle;
  }
  
  /* Improve lang-select nav alignment */
  .lang-select .nav-link {
    display: flex;
    align-items: center;
  }
</style>
<!-- JavaScript für aktive Programm-Optionen und Pfadkorrektur -->
<script>
  // Globale Variable, um mehrfache Initialisierung zu verhindern
  window.navInitialized = window.navInitialized || false;
  
  // Hilfsfunktion zum Umschalten des Dropdowns
  function toggleDropdown(event) {
    if (window.innerWidth <= 1024) {
      event.preventDefault();
      const dropdown = this.closest('.nav-item').querySelector('.program-dropdown');
      if (dropdown) {
        if (dropdown.style.display === 'block') {
          dropdown.style.display = 'none';
        } else {
          dropdown.style.display = 'block';
        }
      }
    }
  }

  // Hilfsfunktion zum fixieren des Body
  function lockBody() {
    document.body.classList.add('no-scroll');
    document.documentElement.classList.add('no-scroll');
    
    // iOS-Fix
    if (window.innerWidth <= 1024) {
      document.body.style.position = 'fixed';
      document.body.style.top = `-${window.scrollY}px`;
      document.body.style.width = '100%';
    }
  }
  
  // Hilfsfunktion zum Entsperren des Body
  function unlockBody() {
    document.body.classList.remove('no-scroll');
    document.documentElement.classList.remove('no-scroll');
    
    // iOS-Fix rückgängig machen
    if (window.innerWidth <= 1024) {
      const scrollY = document.body.style.top;
      document.body.style.position = '';
      document.body.style.top = '';
      document.body.style.width = '';
      window.scrollTo(0, parseInt(scrollY || '0') * -1);
    }
  }

  document.addEventListener('DOMContentLoaded', function() {
    // Prüfen, ob die Navigation bereits initialisiert wurde, um Mehrfach-Initialisierung zu vermeiden
    if (window.navInitialized) return;
    window.navInitialized = true;
    
    // Pfadkorrektur für verschiedene Verzeichnisebenen
    adjustNavigationPaths();
    
    // Explizit alle "Sprache" Elemente im Desktop-Modus entfernen
    removePageLanguageElements();
    
    // Mobile Menu-Button finden und Click-Event hinzufügen
    const mobileMenuButton = document.getElementById('mobileMenuButton');
    const navMenu = document.querySelector('.nav-menu');
    
    if (mobileMenuButton && navMenu) {
      mobileMenuButton.addEventListener('click', function() {
        navMenu.classList.toggle('active');
        
        // Scrollbalken der Hauptseite komplett entfernen
        if (navMenu.classList.contains('active')) {
          lockBody();
        } else {
          unlockBody();
        }
      });
    }
    
    // Weiterbildung dropdown toggle hinzufügen
    const dropdownToggle = document.querySelector('.toggle-subnav');
    if (dropdownToggle) {
      dropdownToggle.addEventListener('click', toggleDropdown);
    }
    
    // Aktuelle URL ermitteln
    const currentPath = window.location.pathname;
    const currentPage = currentPath.substring(currentPath.lastIndexOf('/') + 1);
    const urlParams = new URLSearchParams(window.location.search);
    const programParam = urlParams.get('program');
    
    // Falls wir auf einer der Programmseiten sind, fügen wir einen Programm-Parameter hinzu
    // Diese Funktion läuft beim ersten Laden der Seite und speichert den Programmtitel
    if (currentPage.startsWith('programm-seite') && !programParam) {
      try {
        // Extrahiere den Titel der aktuellen Seite aus der H1
        const pageH1 = document.querySelector('h1');
        
        if (pageH1) {
          // Füge den aktuellen Programmtitel als URL-Parameter hinzu, ohne die Seite neu zu laden
          const newUrl = new URL(window.location);
          newUrl.searchParams.set('program', pageH1.textContent.trim());
          window.history.replaceState({}, '', newUrl);
        }
      } catch (e) {
        console.error('Fehler beim Hinzufügen des Programm-Parameters:', e);
      }
    }
    
    // Hole den aktualisierten Programm-Parameter
    const updatedProgramParam = new URLSearchParams(window.location.search).get('program');
    
    // Alle Programm-Optionen im Dropdown durchgehen
    const programOptions = document.querySelectorAll('.program-option');
    let hasHighlightedOption = false;
    
    programOptions.forEach(option => {
      const optionHref = option.getAttribute('href');
      const optionText = option.textContent.trim();
      
      // Falls es einen spezifischen Programm-Parameter gibt, verwenden wir diesen
      if (updatedProgramParam && optionText.toLowerCase().includes(updatedProgramParam.toLowerCase())) {
        option.classList.add('highlight-option');
        hasHighlightedOption = true;
        return;
      }
      
      // Prüfen, ob der Link mit der aktuellen Seite übereinstimmt
      if (optionHref === currentPage) {
        // Bei mehreren Links zur gleichen Seite (programm-seite4.html) 
        // prüfen wir, ob die Seitentitel im HTML übereinstimmen
        if (currentPage === "programm-seite4.html" && !hasHighlightedOption) {
          const pageTitle = document.title;
          if (pageTitle && pageTitle.includes(optionText)) {
            option.classList.add('highlight-option');
            hasHighlightedOption = true;
          }
        } else if (!hasHighlightedOption) {
          // Bei eindeutigen Seiten einfach hervorheben
          option.classList.add('highlight-option');
          hasHighlightedOption = true;
        }
      }
    });
    
    // Fallback: Wenn keine Option hervorgehoben wurde und wir auf einer Programmseite sind,
    // heben wir die erste Option mit dem passenden Seitennamen hervor
    if (!hasHighlightedOption && currentPage.startsWith('programm-seite')) {
      programOptions.forEach(option => {
        const optionHref = option.getAttribute('href');
        if (optionHref === currentPage) {
          option.classList.add('highlight-option');
          return;
        }
      });
    }
  });
  
  // Funktion zur Pfadkorrektur je nach Position im Verzeichnisbaum
  function adjustNavigationPaths() {
    const currentPath = window.location.pathname;
    const inManagementSeminarFolder = currentPath.includes('/managementseminare/');
    
    // Links für allgemeine Navigation anpassen
    document.querySelectorAll('[data-base-href]').forEach(link => {
      const baseHref = link.getAttribute('data-base-href');
      let newHref = baseHref;
      
      // Wenn wir im Managementseminare-Ordner sind, passen wir die Pfade entsprechend an
      if (inManagementSeminarFolder) {
        const parentFolder = link.getAttribute('data-parent-folder');
        
        if (parentFolder === 'managementseminare') {
          // Wenn der Link zu einem Managementseminar führt, entfernen wir den Ordnerpfad
          newHref = baseHref;
        } else {
          // Für alle anderen Links fügen wir den relativen Pfad nach oben hinzu
          newHref = '../' + baseHref;
        }
      } else {
        // Wenn wir im Root-Verzeichnis sind
        const parentFolder = link.getAttribute('data-parent-folder');
        if (parentFolder) {
          newHref = parentFolder + '/' + baseHref;
        }
      }
      
      link.setAttribute('href', newHref);
    });
  }
  
  function setupLanguageSwitching() {
    // Aktuelle Seite ermitteln
    const currentPath = window.location.pathname;
    const currentPage = currentPath.substring(currentPath.lastIndexOf('/') + 1);
    
    // Prüfen, ob wir auf einer englischen oder deutschen Seite sind
    const isEnglish = currentPage.includes('_en');
    
    // Links für Desktop-Sprachauswahl finden
    const deLinkDesktop = document.getElementById('lang-de-link');
    const enLinkDesktop = document.getElementById('lang-en-link');
    
    if (deLinkDesktop && enLinkDesktop) {
      // Zuerst beide active classes entfernen
      deLinkDesktop.classList.remove('active');
      enLinkDesktop.classList.remove('active');
      
      // Korrekten Ziel-Link für Deutsch setzen
      if (isEnglish) {
        // Von englisch zu deutsch: page_en.html -> page.html
        const germanPage = currentPage.replace('_en.html', '.html');
        deLinkDesktop.setAttribute('href', germanPage);
        
        // Event-Listener nur einmal hinzufügen
        if (!deLinkDesktop.hasAttribute('data-listener')) {
          deLinkDesktop.setAttribute('data-listener', 'true');
          deLinkDesktop.addEventListener('click', function(e) {
            e.preventDefault();
            // Speichere die aktuelle URL ohne den Dateinamen
            const baseUrl = window.location.href.substring(0, window.location.href.lastIndexOf('/') + 1);
            // Navigiere direkt zur neuen URL
            window.location.href = baseUrl + germanPage;
          });
        }
      } else {
        // Bereits auf deutsch, Link deaktivieren und active setzen
        deLinkDesktop.classList.add('active');
        deLinkDesktop.setAttribute('href', '#');
      }
      
      // Korrekten Ziel-Link für Englisch setzen
      if (!isEnglish) {
        // Von deutsch zu englisch: page.html -> page_en.html
        const englishPage = currentPage.replace('.html', '_en.html');
        enLinkDesktop.setAttribute('href', englishPage);
        
        // Event-Listener nur einmal hinzufügen
        if (!enLinkDesktop.hasAttribute('data-listener')) {
          enLinkDesktop.setAttribute('data-listener', 'true');
          enLinkDesktop.addEventListener('click', function(e) {
            e.preventDefault();
            // Speichere die aktuelle URL ohne den Dateinamen
            const baseUrl = window.location.href.substring(0, window.location.href.lastIndexOf('/') + 1);
            // Navigiere direkt zur neuen URL
            window.location.href = baseUrl + englishPage;
          });
        }
      } else {
        // Bereits auf englisch, Link deaktivieren und active setzen
        enLinkDesktop.classList.add('active');
        enLinkDesktop.setAttribute('href', '#');
      }
    }
    
    // Links für mobile Sprachauswahl finden
    const mobileLanguageOptions = document.querySelectorAll('.only-mobile-lang-option');
    
    mobileLanguageOptions.forEach(link => {
      const lang = link.getAttribute('data-lang');
      
      // Zuerst alle active classes entfernen
      link.classList.remove('active');
      
      // Aktuelle Sprache markieren
      if ((lang === 'en' && isEnglish) || (lang === 'de' && !isEnglish)) {
        link.classList.add('active');
      }
      
      // Korrekten Ziel-Link setzen
      if (lang === 'en' && !isEnglish) {
        // Von deutsch zu englisch
        const englishPage = currentPage.replace('.html', '_en.html');
        link.setAttribute('href', englishPage);
        
        // Event-Listener nur einmal hinzufügen
        if (!link.hasAttribute('data-listener')) {
          link.setAttribute('data-listener', 'true');
          link.addEventListener('click', function(e) {
            e.preventDefault();
            // Speichere die aktuelle URL ohne den Dateinamen
            const baseUrl = window.location.href.substring(0, window.location.href.lastIndexOf('/') + 1);
            // Navigiere direkt zur neuen URL
            window.location.href = baseUrl + englishPage;
          });
        }
      } else if (lang === 'de' && isEnglish) {
        // Von englisch zu deutsch
        const germanPage = currentPage.replace('_en.html', '.html');
        link.setAttribute('href', germanPage);
        
        // Event-Listener nur einmal hinzufügen
        if (!link.hasAttribute('data-listener')) {
          link.setAttribute('data-listener', 'true');
          link.addEventListener('click', function(e) {
            e.preventDefault();
            // Speichere die aktuelle URL ohne den Dateinamen
            const baseUrl = window.location.href.substring(0, window.location.href.lastIndexOf('/') + 1);
            // Navigiere direkt zur neuen URL
            window.location.href = baseUrl + germanPage;
          });
        }
      } else {
        // Bleibt auf gleicher Sprache
        link.setAttribute('href', '#');
      }
    });
  }

  // Funktion zum direkten Entfernen des "Sprache"-Elements auf Seitenebene  
  function removePageLanguageElements() {
    // Alle top-level Elemente durchsuchen
    const allDivs = document.querySelectorAll('body > div');
    
    allDivs.forEach(div => {
      // Text enthält "Sprache" und ist nicht die Navigation
      if (div.textContent && 
          div.textContent.includes('Sprache') && 
          !div.id.includes('navigation') && 
          !div.id.includes('sidebar') && 
          !div.id.includes('footer') &&
          !div.classList.contains('only-mobile-lang-section')) {
        div.style.display = 'none';
      }
    });
  }
</script>

<!-- Path correction script -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Detect page location and fix paths
    const currentPath = window.location.pathname;
    const inManagementSeminarFolder = currentPath.includes('/managementseminare/');
    
    // Only adjust links if we're in the managementseminare folder
    if (inManagementSeminarFolder) {
      // Fix managementseminare links by removing the folder prefix
      document.querySelectorAll('.menu-column a[href^="managementseminare/"]').forEach(link => {
        const originalHref = link.getAttribute('href');
        // Extract just the filename
        const fileName = originalHref.replace('managementseminare/', '');
        // Set the correct relative path
        link.setAttribute('href', fileName);
      });
      
      // Fix main navigation links to point back up one level
      document.querySelectorAll('.nav-menu > a:not(.toggle-subnav)').forEach(link => {
        const originalHref = link.getAttribute('href');
        if (originalHref && !originalHref.startsWith('#') && !originalHref.startsWith('http')) {
          link.setAttribute('href', '../' + originalHref);
        }
      });
      
      // Fix the logo link to point to homepage
      const logoLink = document.querySelector('.nav-logo');
      if (logoLink) {
        logoLink.setAttribute('href', '../startseite.html');
      }
    }
  });
</script>

<!-- Direkte Funktion für den Sprachwechsel -->
<script>
  // Globale Funktion zum Wechseln der Sprache
  function switchLanguage(lang, event) {
    if (event) {
      event.preventDefault();
    }
    
    // Aktuelle Seite ermitteln
    const currentPath = window.location.pathname;
    const currentPage = currentPath.substring(currentPath.lastIndexOf('/') + 1);
    const isEnglish = currentPage.includes('_en');
    
    // Sprachpräferenz im Session-Storage speichern
    sessionStorage.setItem('preferredLanguage', lang);
    
    // Zur entsprechenden Sprachversion navigieren
    if (lang === 'en' && !isEnglish) {
      // Von deutsch zu englisch
      window.location.href = currentPage.replace('.html', '_en.html');
      return false;
    } else if (lang === 'de' && isEnglish) {
      // Von englisch zu deutsch
      window.location.href = currentPage.replace('_en.html', '.html');
      return false;
    }
    
    return false;
  }
</script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Aktuelle Seite ermitteln
    const currentPath = window.location.pathname;
    const currentPage = currentPath.substring(currentPath.lastIndexOf('/') + 1).toLowerCase();
    
    // Alle Navigationslinks finden
    const navLinks = document.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
      // Zielseite des Links
      const href = link.getAttribute('href') ? link.getAttribute('href').toLowerCase() : '';
      // Startseiten-Logik: index.html, index_en.html, startseite.html, startseite_en.html
      const isHome = [
        'index.html', 'index_en.html', 'startseite.html', 'startseite_en.html'
      ].includes(currentPage) && (href === 'index.html' || href === 'index_en.html');
      // Standard-Logik: exakte Übereinstimmung
      const isExact = href && href === currentPage;
      if (isHome || isExact) {
        link.classList.add('active');
      } else {
        link.classList.remove('active');
      }
    });
  });
</script>
