<!-- ============ NAVIGATION WITHOUT SUBNAVIGATION ============ -->
<!-- 
  This component serves as the central navigation for all pages of the website.
  Unlike navigation.html, this one lacks the subnavigation for tracks.
  
  To use this component, there are two options:
  
  1. For HTML files with PHP support:
     <?php include('components/globals/navigation_ohnesub_en.html'); ?>
  
  2. For pure HTML files with JavaScript:
     <div id="navigation-container"></div>
     <script>
       fetch('components/globals/navigation_ohnesub_en.html')
         .then(response => response.text())
         .then(data => {
           document.getElementById('navigation-container').innerHTML = data;
         });
     </script>
  
  Changes to this file will be automatically applied to all pages
  that include this component.
-->

<div class="nav-wrapper">
  <nav class="main-nav">
    <div class="nav-container">
      <a href="index_en.html" class="nav-logo" data-base-href="index_en.html">
        <img src="assets/pictures/imt_logo.png" alt="StGallen Integrated imt Business School">
      </a>
      
      <div class="nav-menu" id="mobileNavMenu">
        <a href="index_en.html" class="nav-link" data-base-href="index_en.html">StGallen imt</a>
        <div class="nav-item">
          <a href="#" class="nav-link toggle-subnav" onclick="mobileMenuToggle(event, this)">Programs<svg width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></a>
          <div class="program-dropdown" id="mobile-program-dropdown">
            <!-- First column: Individual seminars -->
            <div class="menu-column">
              <h3>Management Seminars</h3>
              <a href="integrated_management_strategy_en.html" class="program-option" id="integrated-management-option" data-base-href="integrated_management_strategy_en.html" data-parent-folder="managementseminare">Integrated Management and Strategy</a>
              <a href="financial_management_en.html" class="program-option" id="financial-management-option" data-base-href="financial_management_en.html" data-parent-folder="managementseminare">Financial Management</a>
              <a href="inspirational_leadership_en.html" class="program-option" id="inspirational-leadership-option" data-base-href="inspirational_leadership_en.html" data-parent-folder="managementseminare">Inspirational Leadership</a>
              <a href="marketing_sales_brand_communication_en.html" class="program-option" id="marketing-sales-option" data-base-href="marketing_sales_brand_communication_en.html" data-parent-folder="managementseminare">Marketing, Sales and Brand Communication</a>
              <a href="intelligent_process_automation_en.html" class="program-option" id="process-automation-option" data-base-href="intelligent_process_automation_en.html" data-parent-folder="managementseminare">Intelligent Process Automation</a>
              <a href="ai_augmented_decision_making_en.html" class="program-option" id="ai-decision-making-option" data-base-href="ai_augmented_decision_making_en.html" data-parent-folder="managementseminare">AI-Augmented Decision Making</a>
            </div>
            
            <!-- Second column: Programs -->
            <div class="menu-column">
              <h3>Programs</h3>
              <a href="management_programm_en.html" class="program-option" data-base-href="management_programm_en.html">StGallen Management Program</a>
              <a href="management_programm_cas_en.html" class="program-option" data-base-href="management_programm_cas_en.html">StGallen Certified Management CAS</a>
              <a href="ki_excellence_programm_en.html" class="program-option" data-base-href="ki_excellence_programm_en.html">StGallen AI Excellence Management Program</a>
              <a href="fast_track_mba_en.html" class="program-option" data-base-href="fast_track_mba_en.html">StGallen Fastâ€‘Track MBA Program</a>
            </div>
          </div>
        </div>
        <a href="netzwerk_en.html" class="nav-link" data-base-href="netzwerk_en.html">Network</a>
        <a href="research_en.html" class="nav-link" data-base-href="research_en.html">Research</a>
        <a href="support_en.html" class="nav-link" data-base-href="support_en.html">Support</a>
        <a href="kontakt_en.html" class="nav-link" data-base-href="kontakt_en.html">Contact</a>
        
        <!-- Mobile language section - this is only for mobile view -->
        <div class="only-mobile-lang-section">
          <div class="only-mobile-lang-title">Language</div>
          <div class="only-mobile-lang-options">
            <a href="#" class="only-mobile-lang-option" data-lang="de" onclick="return switchLanguage('de', event);"><img src="assets/icons/de-flag-round.png" alt="Deutsch" class="lang-flag-mobile" /> Deutsch</a>
            <a href="#" class="only-mobile-lang-option active" data-lang="en" onclick="return switchLanguage('en', event);"><img src="assets/icons/en-flag-round.png" alt="English" class="lang-flag-mobile" /> English</a>
          </div>
        </div>
      </div>
      
      <div class="lang-select">
        <a href="#" class="nav-link"><img src="assets/icons/en-flag-round.png" alt="English" class="lang-flag-nav" /> EN <svg width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></a>
        <div class="program-dropdown lang-dropdown">
          <a href="#" id="lang-de-link" class="program-option" data-lang="de"><img src="assets/icons/de-flag-round.png" alt="Deutsch" class="lang-flag" /> Deutsch</a>
          <a href="#" id="lang-en-link" class="program-option active" data-lang="en"><img src="assets/icons/en-flag-round.png" alt="English" class="lang-flag" /> English</a>
        </div>
      </div>
      
      <button class="mobile-menu-btn" id="mobileMenuButton" onclick="toggleMobileMenu()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="3" y1="9" x2="21" y2="9"></line>
          <line x1="3" y1="15" x2="21" y2="15"></line>
        </svg>
      </button>
    </div>
  </nav>
</div>

<style>
  :root {
    --font-sans: -apple-system,BlinkMacSystemFont,"San Francisco","Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;
    --color-text: #1d1d1f;
    --color-muted: #6e6e73;
    --color-card-bg: #f5f5f7;
    --color-accent2: #970289;
    --color-badge: #e2b245;
    --color-badge-hover: #d4a535;
    --spacing: 24px;
    --radius: 16px;
    --max-width: 1200px;
    --imt-purple: #6e45e2;
  }

  /* Navigation Wrapper and Container */
  .nav-wrapper {
    position: fixed;
    left: 0;
    right: 0;
    top: 0;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    z-index: 1000;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    font-family: var(--font-sans);
    color: var(--color-text);
  }

  .nav-container {
    max-width: var(--max-width);
    width: 90%;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 60px;
    padding: 0;
    position: relative;
  }

  /* Fix for language display in English version */
  .nav-container > .Language,
  .nav-container > .Deutsch,
  .nav-container > .English {
    display: none !important;
  }
  
  .mobile-lang-section {
    display: none;
  }
  
  /* Make sure mobile language section only appears in mobile view */
  @media (max-width: 900px) {
    .mobile-lang-section {
      display: block;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid rgba(0, 0, 0, 0.1);
    }
  }
  /* End of fix */

  /* Main Navigation */
  .main-nav {
    background: #fff;
    border-bottom: 1px solid rgba(0,0,0,0.1);
    width: 100%;
  }

  .nav-logo {
    display: flex;
    align-items: center;
    margin-right: auto;
    height: 26px;
  }

  .nav-logo img {
    height: 100%;
    width: auto;
  }

  .nav-menu {
    display: flex;
    align-items: center;
    gap: 32px;
    margin-right: 0;
  }

  .nav-link {
    color: var(--color-text);
    text-decoration: none;
    font-size: 0.95rem;
    font-weight: 500;
    white-space: nowrap;
    position: relative;
    padding: 8px 0;
    transition: color 0.2s;
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .nav-link svg {
    margin-left: 2px;
    transition: transform 0.2s ease;
  }

  .nav-link:hover {
    color: var(--color-accent2);
    text-decoration: none !important;
  }

  .nav-link.active {
    color: var(--color-accent2);
    text-decoration: none !important;
  }

  /* Prevents underlining of all navigation links */
  .nav-menu a:hover {
    text-decoration: none !important;
  }

  .nav-link.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: var(--color-accent2);
    border-radius: 1px;
  }

  .nav-item:hover .nav-link svg, 
  .lang-select:hover .nav-link svg {
    transform: rotate(180deg);
  }

  /* Dropdown */
  .nav-item {
    position: relative;
  }

  .program-dropdown {
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(-8px);
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    padding: 24px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
    min-width: 850px;
    margin-top: 8px;
    z-index: 1000;
    display: flex;
    gap: 24px;
  }

  .nav-item:hover .program-dropdown,
  .lang-select:hover .program-dropdown {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(0);
  }
  
  /* Columns for seminars and programs */
  .menu-column {
    flex: 1;
  }

  .menu-column h3 {
    font-size: 1rem;
    margin-bottom: 16px;
    color: var(--color-accent2);
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  }
  
  /* Teal color for Programs heading */
  .menu-column:nth-child(2) h3 {
    color: #17a689;
  }

  /* Style rules for all program options */
  .program-option {
    display: block;
    padding: 12px 16px;
    color: var(--color-text);
    text-decoration: none;
    font-size: 0.95rem;
    border-radius: 8px;
    transition: all 0.2s ease;
    line-height: 1.4;
    margin-bottom: 4px;
  }

  .program-option:hover {
    background: var(--color-card-bg);
    color: var(--color-accent2);
  }
  
  /* Teal color for Program options on hover */
  .menu-column:nth-child(2) .program-option:hover {
    color: #17a689;
  }
  
  /* Specially marked option - directly in the HTML definition */
  .highlight-option {
    font-weight: 600;
    background-color: var(--color-card-bg);
    color: var(--color-accent2);
    border-left: 4px solid var(--color-accent2);
    padding-left: 12px;
    border-radius: 0 8px 8px 0; /* Only right side rounded */
  }
  
  /* Options for language selection */
  .lang-dropdown .program-option.active {
    font-weight: 600;
    background-color: var(--color-card-bg);
    color: var(--color-accent2);
    border-left: none;
    padding-left: 16px;
    border-radius: 8px;
  }

  /* Language Selector */
  .lang-select {
    margin-left: 32px;
    position: relative;
  }

  .lang-dropdown {
    right: -16px;
    left: auto;
    min-width: 140px;
    transform: none !important;
    display: block !important;
    padding: 8px !important;
  }

  .lang-select:hover .program-dropdown {
    transform: translateY(0) !important;
  }

  /* Hide the text "Sprache Deutsch English" in the non-mobile version */
  .nav-container .lang-select + .sprache-text,
  .nav-container .lang-select ~ .sprache-text,
  .nav-container .sprache-text,
  .nav-container > div:last-child:not(.lang-select):not(.mobile-menu-btn),
  .nav-container > div:last-child:not(.lang-select):not(.mobile-menu-btn) .Sprache,
  a[href="#"] + .Sprache,
  .Sprache {
    display: none !important;
  }

  /* Mobile Menu */
  .mobile-menu-btn {
    display: none;
    background: none;
    border: none;
    padding: 8px;
    cursor: pointer;
    color: var(--color-text);
    font-size: 24px;
  }

  /* Mobile Styles */
  @media (max-width: 1024px) {
    /* Mobile Navigation */
    .nav-logo {
      z-index: 1010;
      position: relative;
      background-color: white; /* Add background to prevent text showing through */
    }
    
    .nav-menu {
      position: fixed;
      top: 0;
      right: -100%;
      width: 100%;
      background: white;
      height: 100vh;
      flex-direction: column;
      align-items: flex-start;
      padding: 80px 24px 24px;
      transition: right 0.3s ease;
      z-index: 1000;
      gap: 12px;
      margin-right: 0;
      box-shadow: -4px 0 20px rgba(0, 0, 0, 0.1);
      overflow-y: auto; /* Enables scrolling on overflow */
    }
    
    .nav-menu.active {
      right: 0;
    }
    
    .mobile-menu-btn {
      display: block;
      z-index: 1010;
      background-color: white; /* Add background to prevent text showing through */
    }
    
    .nav-link {
      padding: 12px 0;
      width: 100%;
      font-size: 1.1rem;
    }
    
    .nav-item {
      width: 100%;
    }
    
    .program-dropdown {
      position: static;
      transform: none;
      opacity: 1;
      visibility: visible;
      box-shadow: none;
      padding: 12px 0;
      min-width: auto;
      width: 100%;
      margin-top: 0;
      display: none;
      flex-direction: column;
      gap: 12px;
      border-left: none;
      background: #f8f8f8;
      border-radius: 8px;
      left: 0;
    }
    
    /* Important: Disable hover effect on mobile devices */
    .nav-item:hover .program-dropdown {
      opacity: 1;
      visibility: visible;
      transform: none;
      display: none;
    }
    
    .menu-column {
      width: 100%;
      padding: 0 12px;
    }
    
    .menu-column h3 {
      margin-top: 10px;
      font-size: 0.9rem;
      padding-left: 12px;
    }
    
    /* Add more space between last item in first column and Programme heading */
    .menu-column:nth-child(2) h3 {
      margin-top: 24px; /* Increased from 10px to 24px for more spacing */
    }
    
    .program-option {
      width: 100%;
      padding: 10px 12px;
      margin-bottom: 5px;
      font-size: 0.95rem;
      white-space: normal;
      line-height: 1.4;
    }
    
    .lang-select {
      display: none; /* Hides language selection in mobile view */
    }
    
    .lang-dropdown {
      width: 100%;
      right: auto;
      left: 0;
    }
    
    .only-mobile-lang-section {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid rgba(0, 0, 0, 0.1);
      display: block;
    }
    
    .only-mobile-lang-title {
      font-size: 0.9rem;
      color: var(--color-muted);
      margin-bottom: 12px;
      display: block;
    }
    
    .only-mobile-lang-options {
      display: flex;
      gap: 8px;
    }
    
    .only-mobile-lang-option {
      padding: 8px 16px;
      background: var(--color-card-bg);
      border-radius: 30px;
      font-size: 0.9rem;
      color: var(--color-text);
      text-decoration: none;
    }
    
    .only-mobile-lang-option.active {
      background: var(--color-accent2);
      color: white;
    }

    /* Visible dropdown styles */
    .program-dropdown.visible {
      display: block !important;
    }
  }

  @media (min-width: 1025px) {
    /* Hide mobile language section in desktop view */
    .only-mobile-lang-section {
      display: none !important;
    }
    
    /* Hide language elements in desktop view */
    .Language:not(.only-mobile-lang-title),
    body > div > .Language:not(.only-mobile-lang-title),
    .nav-wrapper ~ .Language:not(.only-mobile-lang-title),
    div[class^="Language"]:not(.only-mobile-lang-title),
    span.Language:not(.only-mobile-lang-title),
    .Sprache:not(.only-mobile-lang-title),
    body > div > .Sprache:not(.only-mobile-lang-title),
    .nav-wrapper ~ .Sprache:not(.only-mobile-lang-title),
    div[class^="Sprache"]:not(.only-mobile-lang-title),
    span.Sprache:not(.only-mobile-lang-title) {
      display: none !important;
    }
  }

  /* Swiss Flag Mini */
  .swiss-flag-mini {
    position: relative;
    width: 24px;
    height: 24px;
    background-color: var(--swiss-red);
    border-radius: 2px;
    margin-left: 6px;
  }
  
  .swiss-flag-mini::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
    height: 100%;
    background-color: white;
    border-radius: 2px;
  }

  /* Language Flag Icons */
  .lang-flag {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    margin-right: 8px;
    vertical-align: middle;
    object-fit: cover;
    border: none;
    display: inline-block;
    background-size: contain;
  }
  
  .lang-flag-mobile {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    margin-right: 6px;
    vertical-align: middle;
    object-fit: cover;
    border: none;
    display: inline-block;
    background-size: contain;
  }
  
  .lang-flag-nav {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    margin-right: 4px;
    vertical-align: middle;
    object-fit: cover;
    border: none;
    display: inline-block;
    background-size: contain;
  }
  
  /* Align flag with text in language dropdown */
  .lang-dropdown .program-option {
    display: flex;
    align-items: center;
  }

  /* Align flag with text in mobile language options */
  .mobile-lang-option, .only-mobile-lang-option {
    display: flex;
    align-items: center;
  }

  /* Align flag with language in top nav */
  .nav-link img + svg,
  .nav-link img {
    display: inline-block;
    vertical-align: middle;
  }
  
  /* Improve lang-select nav alignment */
  .lang-select .nav-link {
    display: flex;
    align-items: center;
  }
</style>

<!-- JavaScript for active program options and path correction -->
<script>
  // Global variable to track menu status
  var programMenuOpen = false;
  
  // Direct toggle function for mobile menu
  function toggleMobileMenu() {
    var navMenu = document.getElementById('mobileNavMenu');
    if (navMenu) {
      navMenu.classList.toggle('active');
    }
  }
  
  // Direct toggle for the Program menu
  function mobileMenuToggle(event, element) {
    // Only in mobile view
    if (window.innerWidth <= 1024) {
      event.preventDefault();
      
      // Get dropdown element
      var dropdown = document.getElementById('mobile-program-dropdown');
      
      // Toggle status
      programMenuOpen = !programMenuOpen;
      
      // Set display directly
      if (programMenuOpen) {
        dropdown.style.display = 'block';
        dropdown.classList.add('visible');
      } else {
        dropdown.style.display = 'none';
        dropdown.classList.remove('visible');
      }
    }
  }

  document.addEventListener('DOMContentLoaded', function() {
    // Initialize language switching once the navigation is loaded
    setupLanguageSwitching();
    
    // Remove unwanted language elements
    removePageLanguageElements();
    
    // Also initialize path correction
    adjustNavigationPaths();
    
    // Get current URL
    const currentPath = window.location.pathname;
    const currentPage = currentPath.substring(currentPath.lastIndexOf('/') + 1);
    const urlParams = new URLSearchParams(window.location.search);
    const programParam = urlParams.get('program');
    
    // If we're on one of the program pages, add a program parameter
    // This function runs when the page first loads and saves the program title
    if (currentPage.startsWith('programm-seite') && !programParam) {
      try {
        // Extract the title of the current page from the H1
        const pageH1 = document.querySelector('h1');
        
        if (pageH1) {
          // Add the current program title as a URL parameter without reloading the page
          const newUrl = new URL(window.location);
          newUrl.searchParams.set('program', pageH1.textContent.trim());
          window.history.replaceState({}, '', newUrl);
        }
      } catch (e) {
        console.error('Error adding program parameter:', e);
      }
    }
    
    // Get the updated program parameter
    const updatedProgramParam = new URLSearchParams(window.location.search).get('program');
    
    // Go through all program options in the dropdown
    const programOptions = document.querySelectorAll('.program-option');
    let hasHighlightedOption = false;
    
    programOptions.forEach(option => {
      const optionHref = option.getAttribute('href');
      const optionText = option.textContent.trim();
      
      // If there's a specific program parameter, use it
      if (updatedProgramParam && optionText.toLowerCase().includes(updatedProgramParam.toLowerCase())) {
        option.classList.add('highlight-option');
        hasHighlightedOption = true;
        return;
      }
      
      // Check if the link matches the current page
      if (optionHref === currentPage) {
        // For multiple links to the same page (programm-seite4.html)
        // check if the page titles in the HTML match
        if (currentPage === "programm-seite4.html" && !hasHighlightedOption) {
          const pageTitle = document.title;
          if (pageTitle && pageTitle.includes(optionText)) {
            option.classList.add('highlight-option');
            hasHighlightedOption = true;
          }
        } else if (!hasHighlightedOption) {
          // For unique pages, simply highlight
          option.classList.add('highlight-option');
          hasHighlightedOption = true;
        }
      }
    });
    
    // Fallback: If no option was highlighted and we're on a program page,
    // highlight the first option with the matching page name
    if (!hasHighlightedOption && currentPage.startsWith('programm-seite')) {
      programOptions.forEach(option => {
        const optionHref = option.getAttribute('href');
        if (optionHref === currentPage) {
          option.classList.add('highlight-option');
          return;
        }
      });
    }
  });
  
  // Function to directly remove the "Language" element at page level  
  function removePageLanguageElements() {
    // Search all top-level elements
    const allDivs = document.querySelectorAll('body > div');
    
    allDivs.forEach(div => {
      // Text contains "Language" or "Sprache" and is not the navigation
      if (div.textContent && 
          (div.textContent.includes('Language') || div.textContent.includes('Sprache')) && 
          !div.id.includes('navigation') && 
          !div.id.includes('sidebar') && 
          !div.id.includes('footer') &&
          !div.classList.contains('only-mobile-lang-section')) {
        div.style.display = 'none';
      }
    });
  }
  
  // Function for path correction depending on position in directory tree
  function adjustNavigationPaths() {
    const currentPath = window.location.pathname;
    const inManagementSeminarFolder = currentPath.includes('/managementseminare/');
    
    // Adjust links for general navigation
    document.querySelectorAll('[data-base-href]').forEach(link => {
      const baseHref = link.getAttribute('data-base-href');
      let newHref = baseHref;
      
      // If we're in the managementseminare folder, adjust paths accordingly
      if (inManagementSeminarFolder) {
        const parentFolder = link.getAttribute('data-parent-folder');
        
        if (parentFolder === 'managementseminare') {
          // If the link leads to a management seminar, remove the folder path
          newHref = baseHref;
        } else {
          // For all other links, add the relative path up
          newHref = '../' + baseHref;
        }
      } else {
        // If we're in the root directory
        const parentFolder = link.getAttribute('data-parent-folder');
        if (parentFolder) {
          newHref = parentFolder + '/' + baseHref;
        }
      }
      
      link.setAttribute('href', newHref);
    });
  }
</script>

<!-- Path correction script -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Detect page location and fix paths
    const currentPath = window.location.pathname;
    const inManagementSeminarFolder = currentPath.includes('/managementseminare/');
    
    // Only adjust links if we're in the managementseminare folder
    if (inManagementSeminarFolder) {
      // Fix managementseminare links by removing the folder prefix
      document.querySelectorAll('.menu-column a[href^="managementseminare/"]').forEach(link => {
        const originalHref = link.getAttribute('href');
        // Extract just the filename
        const fileName = originalHref.replace('managementseminare/', '');
        // Set the correct relative path
        link.setAttribute('href', fileName);
      });
      
      // Fix main navigation links to point back up one level
      document.querySelectorAll('.nav-menu > a:not(.toggle-subnav)').forEach(link => {
        const originalHref = link.getAttribute('href');
        if (originalHref && !originalHref.startsWith('#') && !originalHref.startsWith('http')) {
          link.setAttribute('href', '../' + originalHref);
        }
      });
      
      // Fix the logo link to point to homepage
      const logoLink = document.querySelector('.nav-logo');
      if (logoLink) {
        logoLink.setAttribute('href', '../index_en.html');
      }
    }
  });
</script>

<!-- Script for language switching -->
<script>
  function setupLanguageSwitching() {
    // Get current page information
    const currentPath = window.location.pathname;
    const currentPage = currentPath.substring(currentPath.lastIndexOf('/') + 1);
    
    // Check if we're on an English or German page
    const isEnglish = currentPage.includes('_en');
    
    // Find desktop language selection links
    const deLinkDesktop = document.getElementById('lang-de-link');
    const enLinkDesktop = document.getElementById('lang-en-link');
    
    if (deLinkDesktop && enLinkDesktop) {
      // First remove active class from both
      deLinkDesktop.classList.remove('active');
      enLinkDesktop.classList.remove('active');
      
      // Set correct target link for German
      if (isEnglish) {
        // From English to German: page_en.html -> page.html
        const germanPage = currentPage.replace('_en.html', '.html');
        deLinkDesktop.setAttribute('href', germanPage);
        
        // Add click handler to store language preference
        deLinkDesktop.addEventListener('click', function() {
          sessionStorage.setItem('preferredLanguage', 'de');
        });
      } else {
        // Already on German, disable link
        deLinkDesktop.classList.add('active');
        deLinkDesktop.setAttribute('href', '#');
      }
      
      // Set correct target link for English
      if (!isEnglish) {
        // From German to English: page.html -> page_en.html
        const englishPage = currentPage.replace('.html', '_en.html');
        enLinkDesktop.setAttribute('href', englishPage);
        
        // Add click handler to store language preference
        enLinkDesktop.addEventListener('click', function() {
          sessionStorage.setItem('preferredLanguage', 'en');
        });
      } else {
        // Already on English, disable link
        enLinkDesktop.classList.add('active');
        enLinkDesktop.setAttribute('href', '#');
      }
    }
    
    // Find mobile language selection links
    const mobileLanguageOptions = document.querySelectorAll('.only-mobile-lang-option');
    
    mobileLanguageOptions.forEach(link => {
      const lang = link.getAttribute('data-lang');
      
      // First remove all active classes
      link.classList.remove('active');
      
      // Mark current language
      if ((lang === 'en' && isEnglish) || (lang === 'de' && !isEnglish)) {
        link.classList.add('active');
      }
      
      // Set correct target link
      if (lang === 'en' && !isEnglish) {
        // From German to English
        const englishPage = currentPage.replace('.html', '_en.html');
        link.setAttribute('href', englishPage);
        
        // Add click handler to store language preference
        link.addEventListener('click', function() {
          sessionStorage.setItem('preferredLanguage', 'en');
        });
      } else if (lang === 'de' && isEnglish) {
        // From English to German
        const germanPage = currentPage.replace('_en.html', '.html');
        link.setAttribute('href', germanPage);
        
        // Add click handler to store language preference
        link.addEventListener('click', function() {
          sessionStorage.setItem('preferredLanguage', 'de');
        });
      } else {
        // Stay on same language
        link.setAttribute('href', '#');
      }
    });
  }
</script>

<!-- Direct function for language switching -->
<script>
  // Global function for language switching
  function switchLanguage(lang, event) {
    if (event) {
      event.preventDefault();
    }
    
    // Get current page
    const currentPath = window.location.pathname;
    const currentPage = currentPath.substring(currentPath.lastIndexOf('/') + 1);
    const isEnglish = currentPage.includes('_en');
    
    // Store language preference
    sessionStorage.setItem('preferredLanguage', lang);
    
    // Navigate to corresponding language version
    if (lang === 'en' && !isEnglish) {
      // From German to English
      window.location.href = currentPage.replace('.html', '_en.html');
      return false;
    } else if (lang === 'de' && isEnglish) {
      // From English to German
      window.location.href = currentPage.replace('_en.html', '.html');
      return false;
    }
    
    return false;
  }
</script> 