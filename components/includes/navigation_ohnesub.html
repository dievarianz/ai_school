<!-- ============ NAVIGATION OHNE SUBNAVIGATION ============ -->
<!-- 
  Diese Komponente dient als zentrale Navigation für alle Seiten der Website.
  Im Gegensatz zur navigation.html fehlt hier die Subnavigation für die Tracks.
  
  Um diese Komponente zu verwenden, gibt es zwei Möglichkeiten:
  
  1. Bei HTML-Dateien mit PHP-Unterstützung:
     <?php include('components/includes/navigation_ohnesub.html'); ?>
  
  2. Bei reinen HTML-Dateien mit JavaScript:
     <div id="navigation-container"></div>
     <script>
       fetch('components/includes/navigation_ohnesub.html')
         .then(response => response.text())
         .then(data => {
           document.getElementById('navigation-container').innerHTML = data;
         });
     </script>
  
  Änderungen an dieser Datei werden automatisch auf allen Seiten übernommen,
  die diese Komponente einbinden.
-->

<div class="nav-wrapper">
  <nav class="main-nav">
    <div class="nav-container">
      <a href="index.html" class="nav-logo" data-base-href="index.html">
        <img src="assets/pictures/imt_logo.png" alt="StGallen Integrated imt Business School">
      </a>
      
      <div class="nav-menu" id="mobileNavMenu">
        <a href="index.html" class="nav-link" data-base-href="index.html">StGallen imt</a>
        <div class="nav-item">
          <a href="#" class="nav-link" onclick="mobileMenuToggle(event, this)">Programme<svg width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></a>
          <div class="program-dropdown" id="mobile-program-dropdown" style="display: none;">
            <!-- Erste Spalte: Einzelseminare -->
            <div class="menu-column">
              <h3>Managementseminare</h3>
              <a href="integrated_management_strategy.html" class="program-option" id="integrated-management-option" data-base-href="integrated_management_strategy.html" data-parent-folder="managementseminare">Integrated Management and Strategy</a>
              <a href="financial_management.html" class="program-option" id="financial-management-option" data-base-href="financial_management.html" data-parent-folder="managementseminare">Financial Management</a>
              <a href="inspirational_leadership.html" class="program-option" id="inspirational-leadership-option" data-base-href="inspirational_leadership.html" data-parent-folder="managementseminare">Inspirational Leadership</a>
              <a href="marketing_sales_brand_communication.html" class="program-option" id="marketing-sales-option" data-base-href="marketing_sales_brand_communication.html" data-parent-folder="managementseminare">Marketing, Sales and Brand Communication</a>
              <a href="intelligent_process_automation.html" class="program-option" id="process-automation-option" data-base-href="intelligent_process_automation.html" data-parent-folder="managementseminare">Intelligent Process Automation</a>
              <a href="ki_augmented_decision_making.html" class="program-option" id="ki-decision-making-option" data-base-href="ki_augmented_decision_making.html" data-parent-folder="managementseminare">AI-Augmented Decision Making</a>
            </div>
            
            <!-- Zweite Spalte: Programme -->
            <div class="menu-column">
              <h3>Programme</h3>
              <a href="management_programm.html" class="program-option" data-base-href="management_programm.html">StGallen Management Programm</a>
              <a href="management_programm_cas.html" class="program-option" data-base-href="management_programm_cas.html">StGallen Certified Management CAS</a>
              <a href="ki_excellence_programm.html" class="program-option" data-base-href="ki_excellence_programm.html">StGallen AI Excellence Management Programm</a>
              <a href="fast_track_mba.html" class="program-option" data-base-href="fast_track_mba.html">StGallen Fast‑Track MBA Programm</a>
            </div>
          </div>
        </div>
        <a href="netzwerk.html" class="nav-link" data-base-href="netzwerk.html">Netzwerk</a>
        <a href="research.html" class="nav-link" data-base-href="research.html">Research</a>
        <a href="support.html" class="nav-link" data-base-href="support.html">Support</a>
        <a href="kontakt.html" class="nav-link" data-base-href="kontakt.html">Kontakt</a>
        
        <!-- Mobile Sprachauswahl -->
        <div class="mobile-lang-section">
          <div class="lang-title">Sprache</div>
          <div class="mobile-lang-options">
            <a href="#" class="mobile-lang-option active" data-lang="de" onclick="switchLanguage('de', event)">Deutsch</a>
            <a href="#" class="mobile-lang-option" data-lang="en" onclick="switchLanguage('en', event)">English</a>
          </div>
        </div>
      </div>
      
      <div class="lang-select">
        <a href="#" class="nav-link">DE <svg width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></a>
        <div class="program-dropdown lang-dropdown">
          <a href="#" id="lang-de-link" class="program-option active" data-lang="de">Deutsch</a>
          <a href="#" id="lang-en-link" class="program-option" data-lang="en">English</a>
        </div>
      </div>
      
      <button class="mobile-menu-btn" id="mobileMenuBtn" onclick="toggleMobileMenu()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="3" y1="9" x2="21" y2="9"></line>
          <line x1="3" y1="15" x2="21" y2="15"></line>
        </svg>
      </button>
    </div>
  </nav>
</div>

<style>
  :root {
    --font-sans: -apple-system,BlinkMacSystemFont,"San Francisco","Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;
    --color-text: #1d1d1f;
    --color-muted: #6e6e73;
    --color-card-bg: #f5f5f7;
    --color-accent2: #970289;
    --color-badge: #e2b245;
    --color-badge-hover: #d4a535;
    --spacing: 24px;
    --radius: 16px;
    --max-width: 1200px;
    --imt-purple: #6e45e2;
    --swiss-red: #ff0000;
  }

  /* Navigation Wrapper und Container */
  .nav-wrapper {
    position: fixed;
    left: 0;
    right: 0;
    top: 0;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    z-index: 1000;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    font-family: var(--font-sans);
    color: var(--color-text);
  }

  .nav-container {
    max-width: var(--max-width);
    width: 90%;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 60px;
    padding: 0;
    position: relative;
  }

  /* Main Navigation */
  .main-nav {
    background: #fff;
    border-bottom: 1px solid rgba(0,0,0,0.1);
    width: 100%;
  }

  .nav-logo {
    display: flex;
    align-items: center;
    margin-right: auto;
    height: 26px;
  }

  .nav-logo img {
    height: 100%;
    width: auto;
  }

  .nav-menu {
    display: flex;
    align-items: center;
    gap: 32px;
    margin-right: 0;
  }

  .nav-link {
    color: var(--color-text);
    text-decoration: none;
    font-size: 0.95rem;
    font-weight: 500;
    white-space: nowrap;
    position: relative;
    padding: 8px 0;
    transition: color 0.2s;
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .nav-link svg {
    margin-left: 2px;
    transition: transform 0.2s ease;
  }

  .nav-link:hover {
    color: var(--color-accent2);
    text-decoration: none !important;
  }

  .nav-link.active {
    color: var(--color-accent2);
    text-decoration: none !important;
  }

  /* Verhindert die Unterstreichung bei allen Navigationslinks */
  .nav-menu a:hover {
    text-decoration: none !important;
  }

  .nav-link.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: var(--color-accent2);
    border-radius: 1px;
  }

  .nav-item:hover .nav-link svg, 
  .lang-select:hover .nav-link svg {
    transform: rotate(180deg);
  }

  /* Dropdown */
  .nav-item {
    position: relative;
  }

  .program-dropdown {
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(-8px);
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    padding: 24px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
    min-width: 850px;
    margin-top: 8px;
    z-index: 1000;
    display: flex;
    gap: 24px;
  }

  .nav-item:hover .program-dropdown,
  .lang-select:hover .program-dropdown {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(0);
  }
  
  /* Spalten für Seminare und Programme */
  .menu-column {
    flex: 1;
  }

  .menu-column h3 {
    font-size: 1rem;
    margin-bottom: 16px;
    color: var(--color-accent2);
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  }
  
  /* Teal-Farbe für Programme-Überschrift */
  .menu-column:nth-child(2) h3 {
    color: #17a689;
  }

  /* Stilregeln für alle Program-Options */
  .program-option {
    display: block;
    padding: 12px 16px;
    color: var(--color-text);
    text-decoration: none;
    font-size: 0.95rem;
    border-radius: 8px;
    transition: all 0.2s ease;
    line-height: 1.4;
    margin-bottom: 4px;
  }

  .program-option:hover {
    background: var(--color-card-bg);
    color: var(--color-accent2);
  }
  
  /* Teal-Farbe für Programme-Options beim Hover */
  .menu-column:nth-child(2) .program-option:hover {
    color: #17a689;
  }
  
  /* Speziell markierte Option - direkt bei der HTML-Definition */
  .highlight-option {
    font-weight: 600;
    background-color: var(--color-card-bg);
    color: var(--color-accent2);
    border-left: 4px solid var(--color-accent2);
    padding-left: 12px;
    border-radius: 0 8px 8px 0; /* Nur rechte Seite abgerundet */
  }
  
  /* Optionen für die Sprachauswahl */
  .lang-dropdown .program-option.active {
    font-weight: 600;
    background-color: var(--color-card-bg);
    color: var(--color-accent2);
    border-left: none;
    padding-left: 16px;
    border-radius: 8px;
  }

  /* Language Selector */
  .lang-select {
    margin-left: 32px;
    position: relative;
  }

  .lang-dropdown {
    right: -16px;
    left: auto;
    min-width: 140px;
    transform: none !important;
    display: block !important;
    padding: 8px !important;
  }

  .lang-select:hover .program-dropdown {
    transform: translateY(0) !important;
  }

  /* Verstecke den Text "Sprache Deutsch English" in der nicht-mobilen Version */
  .nav-container .lang-select + .sprache-text,
  .nav-container .lang-select ~ .sprache-text,
  .nav-container .sprache-text,
  .nav-container > div:last-child:not(.lang-select):not(.mobile-menu-btn),
  .nav-container > div:last-child:not(.lang-select):not(.mobile-menu-btn) .Sprache,
  a[href="#"] + .Sprache,
  .Sprache {
    display: none !important;
  }

  /* Mobile Menu Button - FIX */
  .mobile-menu-btn {
    display: none;
    background: none;
    border: none;
    padding: 8px;
    cursor: pointer;
    color: var(--color-text);
    font-size: 24px;
    position: relative;
    z-index: 1100;
  }
  
  /* Make sure it appears at mobile sizes */
  @media (max-width: 1024px) {
    .mobile-menu-btn {
      display: block !important;
    }
  }

  /* Mobile Styles komplett überarbeitet */
  @media (max-width: 1024px) {
    /* Basis Mobile Navigation */
    .nav-menu {
      position: fixed;
      top: 64px;
      left: 0;
      width: 100%;
      height: calc(100vh - 64px) !important;
      background: white;
      flex-direction: column;
      align-items: flex-start;
      padding: 20px;
      gap: 20px;
      transform: translateX(-100%);
      transition: transform 0.3s ease;
      overflow-y: auto !important;
      z-index: 1000;
    }
    
    .nav-menu.active {
      transform: translateX(0);
    }
    
    /* Nav Item für Mobile */
    .nav-item {
      width: 100%;
    }
    
    /* Dropdown Styling für Mobile */
    .program-dropdown {
      position: static !important;
      transform: none !important;
      min-width: unset !important;
      width: 100% !important;
      margin: 8px 0 !important;
      box-shadow: none !important;
      border-radius: 8px;
      background-color: var(--color-card-bg);
      
      /* Reset von allen Desktop-Eigenschaften */
      display: none !important;
      opacity: 1 !important;
      visibility: visible !important;
    }
    
    /* Aktiver Zustand überschreibt alle anderen Regeln */
    .program-dropdown.show-mobile {
      display: block !important;
    }
    
    /* WICHTIG: Deaktiviere alle Hover-Effekte auf Mobil vollständig */
    .nav-item:hover .program-dropdown,
    .nav-item:active .program-dropdown,
    .nav-item:focus .program-dropdown {
      display: none !important;
      opacity: 0 !important;
      visibility: hidden !important;
    }
    
    /* Klarmachen dass ein Element klickbar ist */
    .mobile-toggle {
      cursor: pointer;
    }
    
    /* Sprache in mobile */
    .mobile-lang-section {
      display: block !important;
      width: 100%;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    /* Mobile Lang Optionen */
    .mobile-lang-options {
      display: flex;
      gap: 12px;
    }
  }
  
  /* Fix mobile language section */
  .mobile-lang-section {
    width: 100%;
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .lang-title {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 12px;
    color: var(--color-text);
  }
  
  .mobile-lang-options {
    display: flex;
    gap: 12px;
  }
  
  .mobile-lang-option {
    font-size: 0.95rem;
    color: var(--color-text);
    text-decoration: none;
    padding: 8px 16px;
    border-radius: 6px;
    background: var(--color-card-bg);
    transition: all 0.2s ease;
  }
  
  .mobile-lang-option.active {
    background: var(--imt-purple);
    color: white;
  }
  
  /* Hide mobile language section in desktop view */
  @media (min-width: 1025px) {
    .mobile-lang-section {
      display: none !important;
    }
  }

  /* Swiss Flag Mini */
  .swiss-flag-mini {
    position: relative;
    width: 24px;
    height: 24px;
    background-color: var(--swiss-red);
    border-radius: 2px;
    margin-left: 6px;
  }
  
  .swiss-flag-mini::after {
    content: "";
    position: absolute;
    background-color: white;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 14px;
    height: 14px;
    clip-path: polygon(0% 33%, 33% 33%, 33% 0%, 66% 0%, 66% 33%, 100% 33%, 100% 66%, 66% 66%, 66% 100%, 33% 100%, 33% 66%, 0% 66%);
  }

  .made-in-text {
    font-size: 0.75rem;
    color: var(--color-muted);
    margin-left: 12px;
    display: flex;
    align-items: center;
    font-weight: 500;
  }

  /* Ensure mobile language section is visible in mobile view */
  @media (max-width: 1024px) {
    .mobile-lang-section {
      display: block !important;
      width: 100%;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    /* Fix for mobile dropdown */
    .mobile-dropdown {
      display: none;
      position: static !important;
      transform: none !important;
      opacity: 1 !important;
      visibility: visible !important;
      box-shadow: none !important;
      width: 100% !important;
      min-width: 100% !important;
      margin-top: 8px;
      margin-bottom: 8px;
      border-radius: 8px;
      background-color: var(--color-card-bg);
    }
    
    .mobile-dropdown.show {
      display: block !important;
    }
    
    /* Prevent hover effects from interfering with mobile */
    .nav-item:hover .program-dropdown {
      display: none;
      opacity: 0;
      visibility: hidden;
    }
  }

  /* DIREKTE MOBILE STYLES - NEU */
  @media (max-width: 1024px) {
    /* Mobile Dropdown fixes */
    .mobile-dropdown {
      display: none !important;
      transition: none !important;
      animation: none !important;
    }
    
    .mobile-dropdown.show-mobile {
      display: block !important;
    }
    
    /* Mobile Nav Link */
    .mobile-toggle {
      position: relative;
      z-index: 10;
      cursor: pointer;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    
    /* 100% sicher sein, dass Hover deaktiviert ist */
    .nav-item:hover .program-dropdown,
    .nav-item:focus .program-dropdown,
    .nav-item:focus-within .program-dropdown {
      opacity: 0 !important;
      visibility: hidden !important;
      display: none !important;
    }
    
    /* Language Switcher immer sichtbar */
    .mobile-lang-section {
      display: block !important;
    }
  }
</style>

<!-- Extrem einfaches JavaScript -->
<script>
  // Direkte Funktion zum Sprachwechsel
  function switchLanguage(lang, event) {
    event.preventDefault();
    
    // Aktuellen Seitenpfad ermitteln
    const currentPath = window.location.pathname;
    const currentPage = currentPath.substring(currentPath.lastIndexOf('/') + 1);
    const currentSearch = window.location.search || '';
    
    // Zielseite bestimmen
    let targetPage;
    if (lang === 'de' && currentPage.includes('_en.html')) {
      // Wechsel von Englisch zu Deutsch
      targetPage = currentPage.replace('_en.html', '.html');
      window.location.href = targetPage + currentSearch;
    } else if (lang === 'en' && !currentPage.includes('_en.html')) {
      // Wechsel von Deutsch zu Englisch
      targetPage = currentPage.replace('.html', '_en.html');
      window.location.href = targetPage + currentSearch;
    }
  }
  
  // Globale Variable zum Tracken des Menü-Status
  var programMenuOpen = false;
  
  // Direkter Toggle für das Programm-Menü
  function mobileMenuToggle(event, element) {
    // Nur in mobiler Ansicht
    if (window.innerWidth <= 1024) {
      event.preventDefault();
      
      // Dropdown-Element holen
      var dropdown = document.getElementById('mobile-program-dropdown');
      
      // Status umschalten
      programMenuOpen = !programMenuOpen;
      
      // Display direkt setzen
      if (programMenuOpen) {
        dropdown.style.display = 'block';
        dropdown.classList.add('visible');
      } else {
        dropdown.style.display = 'none';
        dropdown.classList.remove('visible');
      }
    }
  }
  
  // Einfache Toggle-Funktion für mobiles Hauptmenü
  function toggleMobileMenu() {
    var navMenu = document.getElementById('mobileNavMenu');
    if (navMenu) {
      navMenu.classList.toggle('active');
      
      // Programmmenü zurücksetzen beim Schließen
      if (!navMenu.classList.contains('active')) {
        var dropdown = document.getElementById('mobile-program-dropdown');
        if (dropdown) {
          dropdown.style.display = 'none';
          dropdown.classList.remove('visible');
          programMenuOpen = false;
        }
      }
    }
  }
  
  // Bei Seitenladung 
  document.addEventListener('DOMContentLoaded', function() {
    // Spracheinstellungen initialisieren
    setupLanguageSwitching();
    
    // Beim Klick außerhalb des Menüs schließen
    document.addEventListener('click', function(e) {
      if (window.innerWidth <= 1024) {
        var navItem = e.target.closest('.nav-item');
        var dropdown = document.getElementById('mobile-program-dropdown');
        
        // Wenn wir außerhalb klicken und das Menü offen ist
        if (!navItem && programMenuOpen && dropdown) {
          dropdown.style.display = 'none';
          dropdown.classList.remove('visible');
          programMenuOpen = false;
        }
      }
    });
    
    // Pfade anpassen basierend auf Verzeichnisstruktur
    adjustNavigationPaths();
  });
</script>

<!-- Path correction script -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Detect page location and fix paths
    const currentPath = window.location.pathname;
    const inManagementSeminarFolder = currentPath.includes('/managementseminare/');
    
    // Only adjust links if we're in the managementseminare folder
    if (inManagementSeminarFolder) {
      // Fix managementseminare links by removing the folder prefix
      document.querySelectorAll('.menu-column a[href^="managementseminare/"]').forEach(link => {
        const originalHref = link.getAttribute('href');
        // Extract just the filename
        const fileName = originalHref.replace('managementseminare/', '');
        // Set the correct relative path
        link.setAttribute('href', fileName);
      });
      
      // Fix main navigation links to point back up one level
      document.querySelectorAll('.nav-menu > a:not(.toggle-subnav)').forEach(link => {
        const originalHref = link.getAttribute('href');
        if (originalHref && !originalHref.startsWith('#') && !originalHref.startsWith('http')) {
          link.setAttribute('href', '../' + originalHref);
        }
      });
      
      // Fix the logo link to point to homepage
      const logoLink = document.querySelector('.nav-logo');
      if (logoLink) {
        logoLink.setAttribute('href', '../index.html');
      }
    }
  });
</script>

<!-- Komplett überarbeitete Mobile Navigation -->
<script>
  // Globale Variable um zu tracken, ob wir auf Mobil oder Desktop sind
  let isMobileView = window.innerWidth <= 1024;
  
  // Bei Page-Load initialisieren
  document.addEventListener('DOMContentLoaded', function() {
    // Initialisiere die Navigation entsprechend der Viewport-Größe
    updateNavigationMode();
    
    // Sprachen-Setup
    setupLanguageSwitching();
    
    // Window resize event für responsive Anpassung
    window.addEventListener('resize', function() {
      const wasMobile = isMobileView;
      isMobileView = window.innerWidth <= 1024;
      
      // Nur wenn sich der Modus ändert
      if (wasMobile !== isMobileView) {
        updateNavigationMode();
      }
    });
  });
  
  // Update basierend auf Mobile/Desktop
  function updateNavigationMode() {
    if (isMobileView) {
      setupMobileNavigation();
    } else {
      cleanupMobileNavigation();
    }
  }
  
  // Mobile Menu Toggle
  function toggleMobileMenu() {
    if (isMobileView) {
      const navMenu = document.getElementById('mobileNavMenu');
      if (navMenu) {
        navMenu.classList.toggle('active');
      }
    }
  }
  
  // Mobile-spezifisches Setup
  function setupMobileNavigation() {
    // Mobile-Toggles finden
    const mobileToggles = document.querySelectorAll('.mobile-toggle');
    
    // Click-Handler hinzufügen
    mobileToggles.forEach(toggle => {
      // Entferne bestehende Handler um doppelte zu vermeiden
      toggle.removeEventListener('click', handleMobileToggleClick);
      // Füge Handler hinzu
      toggle.addEventListener('click', handleMobileToggleClick);
    });
  }
  
  // Click-Handler für Mobile Toggle
  function handleMobileToggleClick(e) {
    if (isMobileView) {
      e.preventDefault();
      e.stopPropagation();
      
      // Dropdown finden
      const dropdown = this.closest('.nav-item').querySelector('.program-dropdown');
      
      // Alle anderen Dropdowns schließen
      document.querySelectorAll('.program-dropdown.show-mobile').forEach(d => {
        if (d !== dropdown) {
          d.classList.remove('show-mobile');
        }
      });
      
      // Dieses Dropdown umschalten
      if (dropdown) {
        dropdown.classList.toggle('show-mobile');
      }
    }
  }
  
  // Cleanup für Desktop-Mode
  function cleanupMobileNavigation() {
    // Mobile-spezifische Klassen entfernen
    document.querySelectorAll('.program-dropdown.show-mobile').forEach(dropdown => {
      dropdown.classList.remove('show-mobile');
    });
    
    // Mobile Menu schließen
    const navMenu = document.getElementById('mobileNavMenu');
    if (navMenu && navMenu.classList.contains('active')) {
      navMenu.classList.remove('active');
    }
  }
  
  // Ensure the language switcher is properly initialized
  function updateMobileLanguageSwitcher() {
    const langSection = document.querySelector('.mobile-lang-section');
    if (langSection) {
      const currentPage = window.location.pathname.substring(window.location.pathname.lastIndexOf('/') + 1);
      const isEnglish = currentPage.includes('_en');
      
      const langLinks = langSection.querySelectorAll('.mobile-lang-option');
      langLinks.forEach(link => {
        const lang = link.getAttribute('data-lang');
        
        // Clear active state
        link.classList.remove('active');
        
        // Set active state based on current page
        if ((lang === 'en' && isEnglish) || (lang === 'de' && !isEnglish)) {
          link.classList.add('active');
        }
        
        // Set proper URLs
        if (lang === 'en' && !isEnglish) {
          const englishPage = currentPage.replace('.html', '_en.html');
          link.setAttribute('href', englishPage);
        } else if (lang === 'de' && isEnglish) {
          const germanPage = currentPage.replace('_en.html', '.html');
          link.setAttribute('href', germanPage);
        } else {
          link.setAttribute('href', '#');
        }
      });
    }
  }
  
  // Add global document click handler to close dropdowns
  document.addEventListener('click', function(e) {
    if (isMobileView) {
      // Only if we're not clicking on a toggle or inside a dropdown
      if (!e.target.closest('.mobile-toggle') && !e.target.closest('.program-dropdown')) {
        // Close all dropdowns
        document.querySelectorAll('.program-dropdown.show-mobile').forEach(dropdown => {
          dropdown.classList.remove('show-mobile');
        });
      }
    }
  });
</script>